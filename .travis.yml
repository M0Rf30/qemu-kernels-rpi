language: bash
cache:
- "$HOME/.ccache"
addons:
  apt:
    packages:
    - ccache
services:
- docker
before_install:
- docker pull m0rf30/arch-arm-crosscompile
script:
- docker run -u root -v $HOME/.ccache:/ccache -v $TRAVIS_BUILD_DIR:/workspace m0rf30/arch-arm-crosscompile:latest
  bash -c "cd /workspace/rpi; CCACHE_DIR=/ccache ./script"
before_deploy:
- git config --local user.name "$GH_USER"
- git config --local user.email "$GH_MAIL"
- export TRAVIS_TAG=${TRAVIS_TAG:-$(date +'%Y%m%d%H%M%S')-$(git log --format=%h -1)}
- git tag $TRAVIS_TAG
deploy:
  provider: releases
  api_key:
    secure: rMksfU3FgHTLyaf/9ftcnlx2o78abjpcc2/oK5qxjM7QOTQ1XobiHfI7rTN23KQVM63UOS1xxGnay1XNHXWb5wV0MzAOYcNeCV2xnbA7rk60ux1uTRMJH2hWGrGxDh+TcVa7zXfhyAPRBi6XHTZUGLWFncnyGfzVChg8Jtr1YUjFO2YRod4iXDQw1HoIPJUXJTYl+6OrPPfbrPAlk0zrGgdX+RHgGtaZWskbQGusy4rZHKCitRU9klgMDoBDb7styto7l3Ipb5DBZBgdxAeRd0+xlECXFWskBmXvLpjwwr6FVhwfX8WPX7kTYiUkkB7l/3z94rKvgvI9t10vCJ6x6jSAKTdPofrYDlfjJh8AZAD3HBGDQkZNTGM/FUvGOvIRnwaoRQEn/FjZ6wKU8ImNgXKGXGwxiEl43s18O4GBpg0nYbApOIHEt8uuwGGccJlsS54c8/KklCeGCxwnO9xUgg6yNJkvcCnufWWhjJB01u+kAbqNe5x9lIfOVolRct9MKOUeF3X0Nu3V5MibjGHHXQO8ZDCs5sG8CkGP4GBd4qqB0onLnGwbb1034hWBBBRE4T6Pi+iAGGLoYaM5ZZuZToRoxHAF36Ge/bqqrabQNxD+cwhLJbSZAJ4kDgzQraTLb7tnIPTnAQtA/RL37H7quFr/3zxZcZDNavjOV1p8mtM=
  file: rpi/build/*
  on:
    repo: M0Rf30/qemu-kernels-rpi-arch-arm
